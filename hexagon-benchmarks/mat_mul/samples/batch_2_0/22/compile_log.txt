Registering autoscheduler...
Dropout seed = 222
Node: output
  Symbolic region required: 
    output.x.min, output.x.max
    output.y.min, output.y.max
  Region computed: 
    output.x.min, output.x.max
    output.y.min, output.y.max
  Stage 0:
    x output.x.min output.x.max
    y output.y.min output.y.max
    Featurization for type UInt32
     Op histogram:
      Constant:   0
      Cast:       0
      Variable:   4
      Param:      0
      Add:        0
      Sub:        0
      Mod:        0
      Mul:        0
      Div:        0
      Min:        0
      Max:        0
      EQ:         0
      NE:         0
      LT:         0
      LE:         0
      And:        0
      Or:         0
      Not:        0
      Select:     0
      ImageCall:  0
      FuncCall:   0
      SelfCall:   0
      ExternCall: 0
      Let:        0
     Memory access patterns. Columns are calls to other Funcs, self-calls, input image access, and stores
      Pointwise:      0 0 0 0
      Transpose:      0 0 0 0
      Broadcast:      0 0 0 0
      Slice:          0 0 0 0
    Featurization for type Float
     Op histogram:
      Constant:   0
      Cast:       0
      Variable:   0
      Param:      0
      Add:        0
      Sub:        0
      Mod:        0
      Mul:        0
      Div:        0
      Min:        0
      Max:        0
      EQ:         0
      NE:         0
      LT:         0
      LE:         0
      And:        0
      Or:         0
      Not:        0
      Select:     0
      ImageCall:  0
      FuncCall:   1
      SelfCall:   0
      ExternCall: 0
      Let:        0
     Memory access patterns. Columns are calls to other Funcs, self-calls, input image access, and stores
      Pointwise:      1 0 0 1
      Transpose:      1 0 0 1
      Broadcast:      1 0 0 1
      Slice:          1 0 0 1
  pointwise: 1 boundary condition: 0 wrapper: 1 input: 0 output: 1
Node: matrix_mul
  Symbolic region required: 
    matrix_mul.x.min, matrix_mul.x.max
    matrix_mul.y.min, matrix_mul.y.max
  Region computed: 
    matrix_mul.x.min, matrix_mul.x.max
    matrix_mul.y.min, matrix_mul.y.max
  Stage 0:
    x matrix_mul.x.min matrix_mul.x.max
    y matrix_mul.y.min matrix_mul.y.max
    Featurization for type UInt32
     Op histogram:
      Constant:   0
      Cast:       0
      Variable:   2
      Param:      0
      Add:        0
      Sub:        0
      Mod:        0
      Mul:        0
      Div:        0
      Min:        0
      Max:        0
      EQ:         0
      NE:         0
      LT:         0
      LE:         0
      And:        0
      Or:         0
      Not:        0
      Select:     0
      ImageCall:  0
      FuncCall:   0
      SelfCall:   0
      ExternCall: 0
      Let:        0
     Memory access patterns. Columns are calls to other Funcs, self-calls, input image access, and stores
      Pointwise:      0 0 0 0
      Transpose:      0 0 0 0
      Broadcast:      0 0 0 0
      Slice:          0 0 0 0
    Featurization for type Float
     Op histogram:
      Constant:   1
      Cast:       0
      Variable:   0
      Param:      0
      Add:        0
      Sub:        0
      Mod:        0
      Mul:        0
      Div:        0
      Min:        0
      Max:        0
      EQ:         0
      NE:         0
      LT:         0
      LE:         0
      And:        0
      Or:         0
      Not:        0
      Select:     0
      ImageCall:  0
      FuncCall:   0
      SelfCall:   0
      ExternCall: 0
      Let:        0
     Memory access patterns. Columns are calls to other Funcs, self-calls, input image access, and stores
      Pointwise:      0 0 0 1
      Transpose:      0 0 0 1
      Broadcast:      0 0 0 1
      Slice:          0 0 0 1
  Stage 1:
    r4$x 0 1535
    x matrix_mul.x.min matrix_mul.x.max
    y matrix_mul.y.min matrix_mul.y.max
    Featurization for type UInt32
     Op histogram:
      Constant:   0
      Cast:       0
      Variable:   8
      Param:      0
      Add:        0
      Sub:        0
      Mod:        0
      Mul:        0
      Div:        0
      Min:        0
      Max:        0
      EQ:         0
      NE:         0
      LT:         0
      LE:         0
      And:        0
      Or:         0
      Not:        0
      Select:     0
      ImageCall:  0
      FuncCall:   0
      SelfCall:   0
      ExternCall: 0
      Let:        0
     Memory access patterns. Columns are calls to other Funcs, self-calls, input image access, and stores
      Pointwise:      0 0 0 0
      Transpose:      0 0 0 0
      Broadcast:      0 0 0 0
      Slice:          0 0 0 0
    Featurization for type Float
     Op histogram:
      Constant:   0
      Cast:       0
      Variable:   0
      Param:      0
      Add:        1
      Sub:        0
      Mod:        0
      Mul:        1
      Div:        0
      Min:        0
      Max:        0
      EQ:         0
      NE:         0
      LT:         0
      LE:         0
      And:        0
      Or:         0
      Not:        0
      Select:     0
      ImageCall:  0
      FuncCall:   2
      SelfCall:   1
      ExternCall: 0
      Let:        0
     Memory access patterns. Columns are calls to other Funcs, self-calls, input image access, and stores
      Pointwise:      0 0 0 0
      Transpose:      0 0 0 0
      Broadcast:      0 0 0 0
      Slice:          0 0 0 0
  pointwise: 0 boundary condition: 0 wrapper: 0 input: 0 output: 0
Node: input_b_im
  Symbolic region required: 
    input_b_im._0.min, input_b_im._0.max
    input_b_im._1.min, input_b_im._1.max
  Region computed: 
    input_b_im._0.min, input_b_im._0.max
    input_b_im._1.min, input_b_im._1.max
  Stage 0:
    _0 input_b_im._0.min input_b_im._0.max
    _1 input_b_im._1.min input_b_im._1.max
    Featurization for type UInt32
     Op histogram:
      Constant:   0
      Cast:       0
      Variable:   4
      Param:      0
      Add:        0
      Sub:        0
      Mod:        0
      Mul:        0
      Div:        0
      Min:        0
      Max:        0
      EQ:         0
      NE:         0
      LT:         0
      LE:         0
      And:        0
      Or:         0
      Not:        0
      Select:     0
      ImageCall:  0
      FuncCall:   0
      SelfCall:   0
      ExternCall: 0
      Let:        0
     Memory access patterns. Columns are calls to other Funcs, self-calls, input image access, and stores
      Pointwise:      0 0 0 0
      Transpose:      0 0 0 0
      Broadcast:      0 0 0 0
      Slice:          0 0 0 0
    Featurization for type Float
     Op histogram:
      Constant:   0
      Cast:       0
      Variable:   0
      Param:      0
      Add:        0
      Sub:        0
      Mod:        0
      Mul:        0
      Div:        0
      Min:        0
      Max:        0
      EQ:         0
      NE:         0
      LT:         0
      LE:         0
      And:        0
      Or:         0
      Not:        0
      Select:     0
      ImageCall:  1
      FuncCall:   0
      SelfCall:   0
      ExternCall: 0
      Let:        0
     Memory access patterns. Columns are calls to other Funcs, self-calls, input image access, and stores
      Pointwise:      0 0 1 1
      Transpose:      0 0 1 1
      Broadcast:      0 0 1 1
      Slice:          0 0 1 1
  pointwise: 1 boundary condition: 0 wrapper: 1 input: 1 output: 0
Node: input_a_im
  Symbolic region required: 
    input_a_im._0.min, input_a_im._0.max
    input_a_im._1.min, input_a_im._1.max
  Region computed: 
    input_a_im._0.min, input_a_im._0.max
    input_a_im._1.min, input_a_im._1.max
  Stage 0:
    _0 input_a_im._0.min input_a_im._0.max
    _1 input_a_im._1.min input_a_im._1.max
    Featurization for type UInt32
     Op histogram:
      Constant:   0
      Cast:       0
      Variable:   4
      Param:      0
      Add:        0
      Sub:        0
      Mod:        0
      Mul:        0
      Div:        0
      Min:        0
      Max:        0
      EQ:         0
      NE:         0
      LT:         0
      LE:         0
      And:        0
      Or:         0
      Not:        0
      Select:     0
      ImageCall:  0
      FuncCall:   0
      SelfCall:   0
      ExternCall: 0
      Let:        0
     Memory access patterns. Columns are calls to other Funcs, self-calls, input image access, and stores
      Pointwise:      0 0 0 0
      Transpose:      0 0 0 0
      Broadcast:      0 0 0 0
      Slice:          0 0 0 0
    Featurization for type Float
     Op histogram:
      Constant:   0
      Cast:       0
      Variable:   0
      Param:      0
      Add:        0
      Sub:        0
      Mod:        0
      Mul:        0
      Div:        0
      Min:        0
      Max:        0
      EQ:         0
      NE:         0
      LT:         0
      LE:         0
      And:        0
      Or:         0
      Not:        0
      Select:     0
      ImageCall:  1
      FuncCall:   0
      SelfCall:   0
      ExternCall: 0
      Let:        0
     Memory access patterns. Columns are calls to other Funcs, self-calls, input image access, and stores
      Pointwise:      0 0 1 1
      Transpose:      0 0 1 1
      Broadcast:      0 0 1 1
      Slice:          0 0 1 1
  pointwise: 1 boundary condition: 0 wrapper: 1 input: 1 output: 0
Edge: matrix_mul -> output
  Footprint: 
    Min 0: output.x.min
    Max 0: output.x.max
    Min 1: output.y.min
    Max 1: output.y.max
  Load Jacobians:
    [ 1   0  ]
    [ 0   1  ]

Edge: input_a_im -> matrix_mul.update(0)
  Footprint: 
    Min 0: matrix_mul.r4$x.min
    Max 0: matrix_mul.r4$x.max
    Min 1: matrix_mul.y.min
    Max 1: matrix_mul.y.max
  Load Jacobians:
    [ 1   0   0  ]
    [ 0   0   1  ]

Edge: input_b_im -> matrix_mul.update(0)
  Footprint: 
    Min 0: matrix_mul.x.min
    Max 0: matrix_mul.x.max
    Min 1: matrix_mul.r4$x.min
    Max 1: matrix_mul.r4$x.max
  Load Jacobians:
    [ 0   1   0  ]
    [ 1   0   0  ]


Pass 0 result:
State with cost 21.074194:

realize: output
output 1c 512c (0, 0) t p
 output 24c 1c (0, 0) t
  realize: matrix_mul
  matrix_mul 4c 3c (0, 0) t
   matrix_mul 16vc 1c (0, 0) *
  matrix_mul 1536c 4c 3c (1, 0) t
   matrix_mul 1c 16vc 1c (1, 0) *
  output 4c 3c (0, 0) t
   output 16vc 1c (0, 0) *
Best cost: 21.074194
AutoSchedule.cpp:3157 ... AutoSchedule.cpp:3217 : 12.481976 ms
Cost evaluated this many times: 61
** Optimal schedule:
Schedule features for output
    num_realizations:                      1.000000
    num_productions:                       1.000000
    points_computed_per_realization:       2359296.000000
    points_computed_per_production:        2359296.000000
    points_computed_total:                 2359296.000000
    points_computed_minimum:               2359296.000000
    innermost_loop_extent:                 12.000000
    innermost_pure_loop_extent:            12.000000
    unrolled_loop_extent:                  12.000000
    inner_parallelism:                     512.000000
    outer_parallelism:                     1.000000
    bytes_at_realization:                  9437184.000000
    bytes_at_production:                   9437184.000000
    bytes_at_root:                         9437184.000000
    innermost_bytes_at_realization:        6144.000000
    innermost_bytes_at_production:         6144.000000
    innermost_bytes_at_root:               6144.000000
    inlined_calls:                         0.000000
    unique_bytes_read_per_realization:     768.000000
    unique_lines_read_per_realization:     3.000000
    allocation_bytes_read_per_realization: 768.000000
    working_set:                           768.000000
    vector_size:                           16.000000
    native_vector_size:                    16.000000
    num_vectors:                           147456.000000
    num_scalars:                           0.000000
    scalar_loads_per_vector:               0.000000
    vector_loads_per_vector:               1.000000
    scalar_loads_per_scalar:               1.000000
    bytes_at_task:                         18432.000000
    innermost_bytes_at_task:               6144.000000
    unique_bytes_read_per_vector:          64.000000
    unique_lines_read_per_vector:          1.000000
    unique_bytes_read_per_task:            9455616.000000
    unique_lines_read_per_task:            1539.000000
    working_set_at_task:                   768.000000
    working_set_at_production:             9437952.000000
    working_set_at_realization:            9437952.000000
    working_set_at_root:                   9437952.000000
Schedule features for matrix_mul
    num_realizations:                      12288.000000
    num_productions:                       12288.000000
    points_computed_per_realization:       192.000000
    points_computed_per_production:        192.000000
    points_computed_total:                 2359296.000000
    points_computed_minimum:               2359296.000000
    innermost_loop_extent:                 12.000000
    innermost_pure_loop_extent:            12.000000
    unrolled_loop_extent:                  12.000000
    inner_parallelism:                     1.000000
    outer_parallelism:                     512.000000
    bytes_at_realization:                  768.000000
    bytes_at_production:                   768.000000
    bytes_at_root:                         9437184.000000
    innermost_bytes_at_realization:        256.000000
    innermost_bytes_at_production:         256.000000
    innermost_bytes_at_root:               6144.000000
    inlined_calls:                         0.000000
    unique_bytes_read_per_realization:     0.000000
    unique_lines_read_per_realization:     0.000000
    allocation_bytes_read_per_realization: 0.000000
    working_set:                           0.000000
    vector_size:                           16.000000
    native_vector_size:                    16.000000
    num_vectors:                           147456.000000
    num_scalars:                           0.000000
    scalar_loads_per_vector:               0.000000
    vector_loads_per_vector:               0.000000
    scalar_loads_per_scalar:               0.000000
    bytes_at_task:                         768.000000
    innermost_bytes_at_task:               256.000000
    unique_bytes_read_per_vector:          0.000000
    unique_lines_read_per_vector:          0.000000
    unique_bytes_read_per_task:            0.000000
    unique_lines_read_per_task:            0.000000
    working_set_at_task:                   768.000000
    working_set_at_production:             768.000000
    working_set_at_realization:            768.000000
    working_set_at_root:                   9437952.000000
Schedule features for matrix_mul.update(0)
    num_realizations:                      12288.000000
    num_productions:                       12288.000000
    points_computed_per_realization:       294912.000000
    points_computed_per_production:        294912.000000
    points_computed_total:                 3623878656.000000
    points_computed_minimum:               3623878656.000000
    innermost_loop_extent:                 18432.000000
    innermost_pure_loop_extent:            12.000000
    unrolled_loop_extent:                  12.000000
    inner_parallelism:                     1.000000
    outer_parallelism:                     512.000000
    bytes_at_realization:                  768.000000
    bytes_at_production:                   768.000000
    bytes_at_root:                         9437184.000000
    innermost_bytes_at_realization:        256.000000
    innermost_bytes_at_production:         256.000000
    innermost_bytes_at_root:               6144.000000
    inlined_calls:                         0.000000
    unique_bytes_read_per_realization:     412416.000000
    unique_lines_read_per_realization:     1542.000000
    allocation_bytes_read_per_realization: 18875136.000000
    working_set:                           0.000000
    vector_size:                           16.000000
    native_vector_size:                    16.000000
    num_vectors:                           226492416.000000
    num_scalars:                           0.000000
    scalar_loads_per_vector:               0.250000
    vector_loads_per_vector:               1.333333
    scalar_loads_per_scalar:               1.583333
    bytes_at_task:                         768.000000
    innermost_bytes_at_task:               256.000000
    unique_bytes_read_per_vector:          68.000000
    unique_lines_read_per_vector:          2.000000
    unique_bytes_read_per_task:            0.000000
    unique_lines_read_per_task:            0.000000
    working_set_at_task:                   768.000000
    working_set_at_production:             768.000000
    working_set_at_realization:            768.000000
    working_set_at_root:                   9437952.000000
State with cost 0.000000:

realize: output
output 1c 512c (0, 0) t p
 output 24c 1c (0, 0) t
  realize: matrix_mul
  matrix_mul 4c 3c (0, 0) t
   matrix_mul 16vc 1c (0, 0) *
  matrix_mul 1536c 4c 3c (1, 0) t
   matrix_mul 1c 16vc 1c (1, 0) *
  output 4c 3c (0, 0) t
   output 16vc 1c (0, 0) *
Func output = get_pipeline().get_func(3);
Func matrix_mul = get_pipeline().get_func(2);
Var x(output.get_schedule().dims()[0].var), xi("xi"), xii("xii"), y(output.get_schedule().dims()[1].var), yi("yi");
RVar r4_x(matrix_mul.update(0).get_schedule().dims()[0].var);
output
    .split(y, y, yi, 3, TailStrategy::ShiftInwards)
    .split(x, x, xi, 64, TailStrategy::ShiftInwards)
    .split(xi, xi, xii, 16, TailStrategy::ShiftInwards)
    .unroll(xi)
    .unroll(yi)
    .vectorize(xii)
    .compute_root()
    .reorder(xii, xi, yi, x, y)
    .parallel(y);
matrix_mul.update(0)
    .split(x, x, xi, 16, TailStrategy::GuardWithIf)
    .unroll(x)
    .unroll(y)
    .vectorize(xi)
    .reorder(xi, x, y, r4_x);
matrix_mul
    .store_in(MemoryType::Stack)
    .split(x, x, xi, 16, TailStrategy::RoundUp)
    .unroll(x)
    .unroll(y)
    .vectorize(xi)
    .compute_at(output, x)
    .reorder(xi, x, y);
Writing schedule to /home/sb54/Hydride/hexagon-benchmarks/halide_standalone_autoscheduler/apps/autoscheduler/samples/batch_2_0/22/schedule.txt...
