<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta content="text/html;charset=ISO-8859-1"
        http-equiv="Content-Type">
  <title>A64 ISA XML for Armv8.6 (2019-12)</title>
</head>
<body>

<div style="text-align: center;">
  <h1 style="text-decoration: underline;">A64 ISA XML for Armv8.6</h1>
  <h1 style="text-decoration: underline;">(2019-12)</h1>
  <h1 style="text-decoration: underline;">13 December 2019</h1>
</div>


<h2>1. Introduction</h2>

<p>
  This is the <span style="font-style: italic;">2019-12</span>
  release of the A64 ISA XML for Armv8.6.
</p>

<p>
  The <a href="ISA_A64_xml_v86A-2019-12/xhtml/notice.html">Proprietary Notice</a>
  gives details of the terms and conditions under which this package
  is provided.
</p>

<p>
  If you have comments on the content of this package, please send
  them by e-mail to
  <a href="mailto:support-aarchv8@arm.com">support-aarchv8@arm.com</a>.
  Give:
  <ul>
    <li>The title, "A64 ISA XML for Armv8.6".</li>
    <li>The version, "2019-12".</li>
    <li>A concise explanation of your comments.</li>
  </ul>
</p>

<!--
<p>
  Additional documentation on the XML structure and ARMv8's extensions
  to the pseudocode language are provided separately
  in <a href="ISA_xml_v2_readme.html">this readme file</a>.
</p>
-->

<br/>


<h2>2. Contents</h2>

<table style="width: 80%; background-color: rgb(223, 223, 224);" border="1" cellpadding="0" cellspacing="0">
  <tbody>
    <tr>
      <td rowspan="2">This Version</td>
      <td>2019-12</td>
      <td>&nbsp;<a href="ISA_A64_xml_v86A-2019-12/xhtml/index.html">[HTML]</a> </td>
      <td>&nbsp;<a href="ISA_A64_xml_v86A-2019-12.pdf">[PDF]</a> </td>
      <td>&nbsp;<a href="ISA_A64_xml_v86A-2019-12/index.xml">[XML]</a> </td>
    </tr>
    <tr>
      <td>with optimized pseudocode</td>
      <td>&nbsp;<a href="ISA_A64_xml_v86A-2019-12_OPT/xhtml/index.html">[HTML]</a> </td>
      <td>&nbsp;<a href="ISA_A64_xml_v86A-2019-12_OPT.pdf">[PDF]</a> </td>
      <td>&nbsp;<a href="ISA_A64_xml_v86A-2019-12_OPT/index.xml">[XML]</a> </td>
    </tr>
    <tr>
      <td rowspan="2">Change Markups</td>
      <td>2019-12 from 2019-09</td>
      <td>&nbsp;<a href="ISA_A64_xml_v86A-2019-12/from-ISA_A64_xml_v86A-2019-09/index.html">[HTML]</a> </td>
      <td>&nbsp;<a href="ISA_A64_xml_diff-v86A-v86A-2019-09-to-v86A-2019-12.pdf">[PDF]</a> </td>
    </tr>
    <tr>
      <td>optimized from non-optimized</td>
      <td>&nbsp;<a href="ISA_A64_xml_v86A-2019-12_OPT/from-ISA_A64_xml_v86A-2019-12/index.html">[HTML]</a> </td>
      <td>&nbsp;<a href="ISA_A64_xml_v86A-2019-12_OPT_diff.pdf">[PDF]</a> </td>
    </tr>
    <tr>
      <td>Previous Version</td>
      <td>2019-09</td>
      <td>&nbsp;<a href="ISA_A64_xml_v86A-2019-09/xhtml/index.html">[HTML]</a> </td>
    </tr>
  </tbody>
</table>

<br/>


<h2>3. Release Notes</h2>

<h3>Change history</h3>

<p>
  The following general changes are made:
</p>

<ul>


  <li>
	<!-- 15691, as345  -->
	The "Operational Information" for the following SVE instructions incorrectly stated that they could be used with a predicated MOVPRFX instruction. That has been corrected to state that they can only be used with an unpredicated MOVPRFX instruction.<br>
		<ul>
			<li>CLASTA (vectors)</li>
			<li>CLASTB (vectors)</li>
			<li>COMPACT</li>
			<li>LASTA (vectors)</li>
			<li>LASTB (vectors)</li>
			<li>SPLICE</li>
		</ul>

	</li>

  <li>
	<!-- 15678 -->
  The description for Advanced SIMD ZIP1 instruction is corrected to state that it reads from the lower half of two source SIMD &amp; FP registers. <br>
	The description for Advanced SIMD ZIP2 instruction is corrected to state that it reads from the upper half of two source SIMD &amp; FP registers.
  </li>

  <li>
	<!-- 15793 -->
	The decode pseudocode for A64 instructions BRK, HLT, BTI, PACIASP, PACIBSP was appearing incorrectly and has been updated to reflect the correct code.
	</li>

  <li>
  <!-- 15596 -->
  The pseudocode for the Advanced SIMD UADDLP and SADDLP instructions, whilst previously correct, has been updated to more intuitively describe the UADDLP and SADDLP instructions.
  </li>

  <li>
  <!--u1000 -->
  The text in the "Operational information" section which describes the conditions under which an SVE instruction may be predictably prefixed by a MOVPRFX instruction has been clarified.
  </li>

</ul>


<p>
  The following changes are made to the Shared Pseudocode:
</p>

<ul>

	<li>
	<!-- 15779 -->
	In functions CheckSVEEnabled(), IsSVEEnabled(), AArch64.IsFPEnabled(), CheckFPAdvSIMDEnabled(), and CheckFPAdvSIMDTrap() checks of the FPEN and ZEN fields in CPACR_EL1, CPTR_EL2, and CPTR_EL3 have been made consistent. In the functions CheckAdvSIMDOrFPEnabled() and AArch32.IsFPEnabled(), the check for CPACR.cp10 Constrained Unpredictable behaviour is moved to the existing case statement.
	</li>

  <li>
	<!-- 15774-->
	Added a definition of the NVMem[] accessors in both the assignment and Non-assignment forms.
	</li>

	<li>
	<!-- 15739 -->
	The function AArch64.CheckForERetTrap() had an error in the part of code that describes trap of ERET to EL2 due to fine grained trap controls. This has been corrected.
	</li>

  <li>
	<!-- 15736-->
	The function AArch64.ReportException() now checks the current security state is secure before updating the value of HPFAR_EL2.NS.
	</li>

	<li>
	<!-- 15720 -->
	The function SecondStageTranslate() now sets memory attributes to Normal Non-cacheable when HCR_EL2.PTW is 0 and the translation table is in Device memory.
	</li>

	<li>
	<!-- 15700 -->
	Fixed check in DebugTargetFrom() function that determines whether debug exceptions should be routed to EL2.
	</li>

	<li>
	<!-- 15683 -->
	The functions CombineS1S2Desc() and CombineS1S2AttrHints() are refactored to remove redundancy in the code.
	</li>

	<li>
	<!-- 15645 -->
	Corrected the AArch64.TakeException() and AArch64.TakeExceptionInDebugState() functions to read the SCTLR register of the target exception level.
	</li>

	<li>
	<!-- 15562 -->
	The values for shareable and outershareable memory attributes have been initialised when apply_forced_writeback is enabled in S2AttrDecode(). Earlier they were not initialised.
	</li>

	<li>
	<!-- 15531 -->
	In functions AArch32.BreakpointValueMatch(), AArch64.BreakpointValueMatch(), and CreatePCSample() the checks for HaveVirtHostExt() before using CONTEXTIDR_EL2 are changed to a check for whether CONTEXTIDR_EL2 is implemented.
	</li>

	<li>
	<!-- 15453 -->
	The Strip() function is corrected to remove the incorrect trapping of instructions XPACD, XPACI, XPACLRI with the HCR_EL2.API and the SCR_EL3.API control bits.
	</li>
	<li>
	<!-- 15436-->
	The function InterruptPending() now additionally checks for physical and virtual IRQ and FIQ interrupts.
	</li>

	<li>
	<!-- 15363 -->
	The function AArch64.TakeException() did not set the correct value of 0b10 (and not 0b01) to SPSR_EL1.M[3:2] when HCR_EL2.{NV2, NV} == {1,1} and an exception is taken from EL1 and taken to EL1.
	</li>


	<li>
	<!-- 15017-->
	With the addition of TTST(Small Page Table) feature, TxSZ can now hold a maximum value of 48, giving a minimum input size of 16. This could lead to more cases which results in the misprogramming of the contiguous bit. One such case is that the given input size is not within the addressable range. This change is checking for the same case dynamically using the new values of TnSZ and input size.
	</li>

	<li>
	<!-- 14582 -->
	Bits 60 to 63 of a faulting Virtual Address reported for a Synchronous Tag Check Fail abort written to FAR_EL1, FAR_EL2 or FAR_EL3 are now reported as UNKNOWN.
	</li>

  <li>
	<!-- 14189 -->
	Usage of the function SetNotTagCheckedInstruction() is inverted and the function is renamed as SetTagCheckedInstruction().
	</li>

</ul>

<h3>Known issues</h3>

<ul>
  <li>
    AArch64 Pseudocode does not describe the configurable delay in the trapping of WFE instructions as defined by the v8.6 TWED feature.
  </li>

  <li>
		<!-- 15875 -->
    For the following functions:
      <ul>
		      <li>S2CacheDisabled() </li>
		      <li>S2ConvertAttrsHints()</li>
      </ul>
		Current pseudocode does not consider the effect of HCR_EL2.CD when HCR_EL2.FWB == 1

	</li>

</ul>


<br/>


<h3>Potential upcoming changes</h3>

	<ul>

	</ul>
</body></html>
