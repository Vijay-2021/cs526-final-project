# Hydride

Hydride is a retargetable synthesis-based compiler for modern tensor architectures.

Hydride has two major components:
- Back-end - It is responsible for automatically generating target-agnostic DSL in Rosette for synthesis, LLVM IR extensions and legalization code.
- Mid-end - It leverages Rosette to synthesize tensor and stencil computations using the DSL automatically generated by the Backend.

## Prerequisites

### Python
- Install [Python][] > 3.0.

### Rosette
- Install [Racket][] > 8.0.
- Install [Rosette][] by running `raco pkg install rosette`.

### Z3
- Install [z3][]:
    - MacOS: `brew install z3`
    - Linux example: `sudo apt-get install -y z3`

### LLVM
- Install [LLVM][]:
    - Source: `git clone -b release/13.x https://github.com/llvm/llvm-project.git`

## Directory Structure (WIP)
- `cost-experiments` contains the experimental files for adding the notion of cost for different benchmark kernels.
- `dsl-synthesizer-gen` contains code for automatically generating rosette grammar and code for performing synthesis.
- `halide-examples` contains tensor and stencil kernels implemented in Halide.
- `rose-IR` contains the custom compiler to generate target-agnostic DSL in Rosette for synthesis, LLVM IR extensions and legalization code.
- `rosette` tracks all the changes made to Rosette to synthesize code for Hydride.
- `synth-benchmarks` contains the benchmarks synthesized for which Hydride generates vector instructions.

## Targets Supported (WIP)
- x86 (AVX, SSE, VNNI)
- Hexagon (HVX)
